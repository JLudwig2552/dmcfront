<div class="page-header" layout-padding>
	<md-toolbar>
		<div class="md-toolbar-tools">
			<div layout="column">
				<h1 class="name-project">
					<div sub-nav-menu-button current-page="1"></div>
					{{projectData.title}}
					<span class="small-text small-text--grey">Due in 20 days</span>
				</h1>
				<span ng-if="isPreview" class="project-manager">Submitted: {{projectData.projectManager}}</span>
			</div>      
		</div>
	</md-toolbar>
</div>
<div class="project-details-services" ng-if="!flagHistory" layout="column">
	<a class="link margin-bottom8" ng-href="{{'project.php#/' + projectData.id + '/services'}}">
		Return to Services
	</a>
	<div layout="row" layout-align="space-between start">
		<div layout="column" class="header">
			<h2><a ng-href="{{(service.from == 'marketplace')?'service-marketplace.php#/' + service.id : ''}}">{{service.title}}</a> <span>By {{service.owner}}</span></h2>
			<a ng-click="showHistory()" class="link margin-top8">
				Run History
			</a>
			<ui-widget-stars-static size="15" value="{{average_rating}}" text="({{average_rating}}) {{number_of_comments}} reviews"></ui-widget-stars-static>
		</div>
		<div class="buttons" layout layout-align="center center">
			<md-button class="md-raised" ui-sref="project.run-services({ServiceId : service.id})">
				Run
			</md-button>
			<md-button class="md-raised" ng-click="follow()">
				{{(followFlag) ? 'Unfollow' : 'Follow'}}
			</md-button>
			<md-button aria-label="reply" href="" class="md-icon-button reply header-icon">
				<ng-md-icon icon="reply" style="fill: grey;" size="25"></ng-md-icon>
			</md-button>
			<md-button aria-label="create" ng-href="{{'project.php#/' + projectData.id + '/edit-service'}}" class="md-icon-button header-icon">
				<ng-md-icon icon="create" style="fill: grey;" size="25"></ng-md-icon>
			</md-button>
			<md-button aria-label="delete" ng-click="delete()" class="md-icon-button header-icon">
				<ng-md-icon icon="delete" style="fill: grey;" size="25"></ng-md-icon>
			</md-button>
		</div>
	</div>
	<div class="description">
		{{service.description}}
	</div>
	<md-tabs md-dynamic-height md-border-bottom>
		<md-tab label="STATISTICS">
			<ui-widget-tabs-statistic data="statistics" filter="filter"></ui-widget-tabs-statistic>
		</md-tab>
		
		<md-tab label="HISTORY">
			<ui-widget-tabs-history data="history" filters="filter"></ui-widget-tabs-history>
		</md-tab>

		<md-tab label="TAGS">
			<md-content class="md-padding">
				<div layout="row" class="tabs-content" layout-wrap>
					<md-chips ng-repeat="tag in service.tags track by $index">
						<md-chip ng-click="search(tag)">
							<a ng-href="/marketplace.php#/search/services?text={{tag}}">{{tag}}</a>
						</md-chip>
					</md-chips>
				</div>
			</md-content>
		</md-tab>

		<md-tab label="DOCUMENTS">
			<md-content class="md-padding">
                <ui-widget-documents-folder documents-type="'service'" type-id="service.id"></ui-widget-documents-folder>
			</md-content>
		</md-tab>

		<md-tab ng-if="service.from == 'marketplace'" label="Reviews">
			<div layout="row" layout-align="start center">
				<h4>{{number_of_comments}} reviews </h4>
				<ui-widget-stars-static size="15" value="{{average_rating}}" text="({{average_rating}})"></ui-widget-stars-static>
			</div>
			<div ng-repeat="review in service.reviews">
				<ui-widget-review review="review" userlogin="'UserLogin'" typereview="'reply_reviews'"></ui-widget-review>
        <md-divider></md-divider>
      </div>
		</md-tab>
	</md-tabs>
</div>

<div class="project-history-services" ng-if="flagHistory" layout="column">
	<h2>{{service.title}}</h2>
	<div layout="row" layout-align="space-between center">
		<a href="" ng-click="showHistory()" class="link">
			Detail Service
		</a>
	</div>
	<h3>Run History</h3>
	<md-content>
		<md-list>
			<div layout="row" class="listHeader">
				<md-button flex="25" ng-click="sorting('runDate')">
					Run Date 
					<ng-md-icon  
						icon="arrow_forward" 
						size="18" 
						ng-if="sort == 'runDate'"
						style="fill: #000"
						ng-style="(sort == 'runDate' && order)? {transform: 'rotate(-90deg)',transition: 'transform 0.25s'}: {transform: 'rotate(90deg)',transition: 'transform 0.25s'}"></ng-md-icon>
				</md-button>
				<md-button flex="25" ng-click="sorting('runBy')">
					Run By
					<ng-md-icon  
						icon="arrow_forward" 
						size="18" 
						ng-if="sort == 'runBy'"
						style="fill: #000"
						ng-style="(sort == 'runBy' && order)? {transform: 'rotate(-90deg)'}: {transform: 'rotate(90deg)'}"></ng-md-icon>
				</md-button>
				<md-button flex="25" ng-click="sorting('runTime')">
					Run Time 
					<ng-md-icon  
						icon="arrow_forward" 
						size="18" 
						ng-if="sort == 'runTime'"
						style="fill: #000"
						ng-style="(sort == 'runTime' && order)? {transform: 'rotate(-90deg)'}: {transform: 'rotate(90deg)'}"></ng-md-icon>
				</md-button>
				<md-button flex="25" ng-click="sorting('results')">
					Results 
					<ng-md-icon  
						icon="arrow_forward" 
						size="18" 
						ng-if="sort == 'results'"
						style="fill: #000"
						ng-style="(sort == 'results' && order)? {transform: 'rotate(-90deg)'}: {transform: 'rotate(90deg)'}"></ng-md-icon>
				</md-button>
			</div>
			<md-list-item ng-repeat="item in runHistory | orderBy:sort:order" layout="row">
				<div flex="25">{{item.runDate}} {{item.runTimeService}}</div>
				<div flex="25"><a href="">{{item.runBy}}</a></div>
				<div flex="25">{{item.runTime}}s</div>
				<div flex="25" style="color:{{(item.results == 'Success') ? '#65AF3F': 'red'}}">
					<a href="" ng-click="openResults(item)" class="href-result">{{item.results}}</a>
				</div>
			</md-list-item>
		</md-list>
	</md-content>
</div>